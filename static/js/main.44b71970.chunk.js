(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,n){},16:function(e,t,n){},17:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),c=n(8),i=n.n(c),s=(n(15),n(2)),u=n(3),r=n(5),l=n(4),m=n(1),h=n(6),k=(n(16),n(17),void 0),d={},f={},p=[],b={production:"wss://stocks.mnet.website",development:"ws://stocks.mnet.website"},v=function(){function e(){Object(s.a)(this,e);var t=b.production;this.socket=new WebSocket(t)}return Object(u.a)(e,[{key:"subscribeForNewStocks",value:function(e){p.push(e)}},{key:"subscribe",value:function(e,t){f[e]||(f[e]=[]),f[e].push(t)}},{key:"unsubscribe",value:function(e,t){f[e]&&(f[e]=[].filter(function(e,n,a){return t!==e}))}},{key:"publish",value:function(e,t){f[e]&&f[e].forEach(function(e){e.call(null,t)})}},{key:"init",value:function(){var e=this;this.socket.onopen=function(){console.log("Connected!")},this.socket.onmessage=function(t){JSON.parse(t.data).forEach(function(t){var n=t[0],a=t[1];d[n]||p.forEach(function(e){e.call(null,n)}),d[n]=a,e.publish(n,a)}),console.log(JSON.stringify(d))},this.socket.onclose=function(){console.log("Lost connection!")},this.socket.onerror=function(){console.log("Error!")}}},{key:"close",value:function(){this.socket.close()}},{key:"getStockPrice",value:function(e){return d[e]?d[e]:0}}],[{key:"getInstance",value:function(){return void 0===k&&(k=new e),k}}]),e}();v.getInstance();var w=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(r.a)(this,Object(l.a)(t).call(this,e))).name=e.name,n.time=(new Date).getTime(),n.stock=v.getInstance().getStockPrice(n.name),n.updateStock=n.updateStock.bind(Object(m.a)(n)),n.updateTime=n.updateTime.bind(Object(m.a)(n)),n.timer=setTimeout(n.updateTime,1e3),n.state={name:e.name,time:"",stock:"",color:"normal"},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"updateTime",value:function(e){var t=(new Date).getTime();t=(t-=this.time)<1e4?"Just Updated":t<3e4?"Few seconds ago":t<3e5?"Minutes ago":new Date(this.time).toLocaleTimeString(),this.setState({time:t}),e||(this.timer=setTimeout(this.updateTime,5e3))}},{key:"updateStock",value:function(e){var t="";this.stock=parseFloat(this.stock),e=parseFloat(e).toFixed(2),t=this.stock<e?"high":this.stock>e?"low":"normal",this.stock=e,this.setState({stock:e,color:t}),this.time=(new Date).getTime(),this.updateTime(!0)}},{key:"componentDidMount",value:function(){v.getInstance().subscribe(this.name,this.updateStock)}},{key:"componentWillUnmount",value:function(){v.getInstance().unsubscribe(this.name,this.updateStock),clearTimeout(this.timer)}},{key:"render",value:function(){return o.a.createElement("tr",null,o.a.createElement("td",null,this.state.name),o.a.createElement("td",{className:this.state.color},this.state.stock),o.a.createElement("td",{className:"timeUpdated"},this.state.time))}}]),t}(o.a.Component),g=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(r.a)(this,Object(l.a)(t).call(this,e))).newStock=n.newStock.bind(Object(m.a)(n)),n.state={stocks:[]},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"newStock",value:function(e){var t=this.state.stocks;t.push(e),this.setState({stocks:t})}},{key:"componentDidMount",value:function(){v.getInstance().init(),v.getInstance().subscribeForNewStocks(this.newStock)}},{key:"render",value:function(){var e=this.state.stocks.map(function(e){return o.a.createElement(w,{name:e})});return o.a.createElement("div",{className:"App"},o.a.createElement("header",{className:"App-header"},o.a.createElement("div",null,o.a.createElement("table",null,o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("td",null,"Stock"),o.a.createElement("td",null,"Price"),o.a.createElement("td",null,"Last Update"))),o.a.createElement("tbody",null,e)))))}}]),t}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(g,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},9:function(e,t,n){e.exports=n(18)}},[[9,1,2]]]);
//# sourceMappingURL=main.44b71970.chunk.js.map